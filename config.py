"""
Конфигурационный файл для телеграм-бота новостей.
Здесь хранятся все основные настройки бота и источники новостей.
"""

import os
from pathlib import Path

from dotenv import load_dotenv

# Загружаем переменные окружения из .env файла
_BASE_DIR = Path(__file__).resolve().parent
# Загружаем только реальные файлы окружения, а не шаблоны с примерами
_ENV_FILENAMES = (".env",)
_ENV_DIRS = (_BASE_DIR, _BASE_DIR.parent, Path.cwd())
for env_dir in _ENV_DIRS:
    for env_name in _ENV_FILENAMES:
        load_dotenv(env_dir / env_name)

# Токен бота, полученный от @BotFather в Telegram
BOT_TOKEN = os.getenv('BOT_TOKEN', '')

# ID канала, куда будут публиковаться новости
# Формат: @channel_username или -1001234567890 (числовой ID)
CHANNEL_ID = os.getenv('CHANNEL_ID', '-1003531603514')

# Максимальная длина поста в символах
MAX_POST_LENGTH = 4500

# Минимальная задержка перед публикацией новости, чтобы сгруппировать похожие темы
PUBLISH_DELAY_MINUTES = 30

# Интервал проверки источников (в секундах)
CHECK_INTERVAL_SECONDS = 60

# Количество новостей для проверки за один раз
NEWS_CHECK_BATCH = 20

# База данных для хранения опубликованных новостей
DATABASE_PATH = 'news_bot.db'

# Дней хранения истории опубликованных новостей в базе
# После этого срока старые записи автоматически удаляются (экономия места)
DAYS_TO_KEEP_HISTORY = 30

# Список источников новостей (RSS фиды)
# Оставляем только политические и мировые новости
NEWS_SOURCES = [
    {'name': 'Коммерсант Политика', 'url': 'https://www.kommersant.ru/RSS/section-politics.xml', 'category': 'politics'},
    {'name': 'RT Политика', 'url': 'https://russian.rt.com/rss/politics', 'category': 'politics'},
    {'name': 'Независимая газета', 'url': 'https://www.ng.ru/rss/', 'category': 'politics'},
    {'name': 'Известия', 'url': 'https://iz.ru/xml/rss/all.xml', 'category': 'politics'},
    {'name': 'ТАСС Мир', 'url': 'https://tass.ru/rss/v2.xml', 'category': 'world'},
    {'name': 'RT Мир', 'url': 'https://russian.rt.com/rss/news', 'category': 'world'},
    {'name': 'BBC Russian', 'url': 'https://www.bbc.com/russian/index.xml', 'category': 'world'},
    {'name': 'Deutsche Welle Russian', 'url': 'https://www.dw.com/ru/rss/rss-ru-all', 'category': 'world'},
    {'name': 'Voice of America Russian', 'url': 'https://www.golosameriki.com/api/zq$omekvi_1q', 'category': 'world'},
    {'name': 'Российская Газета Мир', 'url': 'https://rg.ru/xml/index.xml', 'category': 'world'},
]

# Категории для политики и мировых новостей
CATEGORIES = ['politics', 'world']

# Ключевые слова для отбора политических новостей
POLITICAL_KEYWORDS = [
    'полит', 'власть', 'правительств', 'президент', 'премьер', 'министр',
    'мид', 'мвд', 'госдума', 'дума', 'совфед', 'парламент', 'сенат',
    'конгресс', 'кабинет', 'выбор', 'референдум', 'санкц', 'дипломат',
    'переговор', 'встреча лидеров', 'посол', 'парти', 'оппозиц',
    'закон', 'ратифиц', 'конституц', 'митинг', 'протест', 'демонстрац',
    'кремл', 'белый дом', 'нато', 'оон', 'ес', 'евросоюз', 'сша',
    'украин', 'росси', 'китай', 'герман', 'франц', 'британи', 'япони',
    'israel', 'iran', 'european union', 'nato', 'united nations',
    'government', 'parliament', 'president', 'prime minister', 'election',
    'sanction', 'diplomat', 'foreign ministry'
]

# Ключевые слова для отсева локальной криминальной хроники
LOCAL_NOISE_CRIME_KEYWORDS = [
    'пья', 'пьян', 'алкогол', 'дебош', 'мелк', 'карманн', 'краж', 'вор', 'граб',
    'хулиган', 'свалил', 'угнал велосипед', 'украл велосипед'
]

# Маркеры локальных новостей уровня района/города
LOCAL_NEWS_MARKERS = [
    'в районе', 'на улице', 'местный житель', 'житель ', 'в городе', 'в посёлке', 'в поселке',
    'по области', 'районный', 'городской суд', 'в администрации города'
]

# Признаки «новостей-затычек» (малополезные/пустые материалы)
LOW_VALUE_NEWS_PATTERNS = [
    'без подробностей',
    'детали уточняются',
    'следите за обновлениями',
    'подробности позже',
    'стало известно',
    'шок',
    'срочно',
    'видео',
    'фото'
]

# Минимальная длина осмысленного описания новости
MIN_DESCRIPTION_LENGTH = 80

# Общие криминальные маркеры (фильтруем по умолчанию)
CRIME_CONTENT_KEYWORDS = [
    'убил', 'убий', 'зарезал', 'расстрел', 'стрельб', 'нападен', 'ограб', 'граб', 'краж',
    'вор', 'изнасил', 'мошенн', 'преступ', 'задержан', 'арестован', 'суд приговорил',
    'полиция', 'прокуратур', 'свoдка', 'поножовщина', 'драка', 'разбой', 'хулиган'
]

# Исключения: криминальные события глобального масштаба/террор, которые публикуем
ALLOWED_GLOBAL_CRIME_KEYWORDS = [
    'теракт', 'террорист', 'terror', 'isis', 'игил', 'аль-каида',
    'массовая стрельба', 'вооруженное нападение', 'чрезвычайное положение',
    'санкции', 'международн', 'оон', 'евросоюз', 'нато', 'глобальн',
    'энергетическ', 'кибератак', 'инфраструктур', 'авиасообщени', 'границ'
]
